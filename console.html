<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Situation Room Console</title>
    <style>
body {
    background-color: black;
    color: white;
    font-size: 15px;
}
</style>
<script src="/socket.io/socket.io.js""></script>
<script src="/config.js"></script>
<script src="/static/jquery-1.6.min.js"></script>
<script>
var socket = new io.Socket(SETTINGS.HOST, {port: SETTINGS.CONSOLE_PORT}); 
socket.connect();
socket.on('message', function(event) {
    console.log(event);
    cmd = JSON.parse(event);
    var w = $('#url' + cmd['window']);
    w.val(cmd['url']);
    w = $('#refresh' + cmd['window']);
    w.val(cmd['refresh']);
    $('#type' + cmd['window'] + ' ').val(cmd['cmd']);
});

setInterval(function () {
    if (!socket.connected) {
        socket.connect();
    }
}, 1000);

function send_command(cmd)
{
    cmd['display'] = 0;
    socket.send(JSON.stringify(cmd));
    return false;
}

function full(window) {
    return send_command({cmd: "full", window: window});
}

function change(window) {
    if ($('#type' + window).val() == "webpage") {
        return send_command({cmd: "webpage", window: window, url: $('#url' + window).val(), refresh:  $('#refresh' + window).val()});
    }
    if ($('#type' + window).val() == "image") {
        return send_command({cmd: "image", window: window, url: $('#url' + window).val(), refresh: $('#refresh' + window).val()});
    }
    return false;
}

function mosaic() {
    return send_command({cmd: "mosaic"});
}
</script>
</head>
<body>
<h1>Situation Room</h1>
<input type="button" onclick="mosaic()" value="Mosaic"/>
<table>
    <thead>
        <tr>
            <th>Window</th>
            <th>Url</th>
            <th>Refresh</th>
            <th>Type</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody id="content">
    </tbody>
</table>
<script>
for (var i = 0; i < 4; i++) {
    var tr = $('<tr>');
    tr.append($('<td>').text(i + 1))
    tr.append(
        $('<td>').append(
            $('<input>').attr('type', 'text').attr('id', 'url' + i).attr('size', 100)
        )
    );
    tr.append(
        $('<td>').append(
            $('<input>').attr('type', 'text').attr('id', 'refresh' + i).attr('size', 10).val(0)
        )
    );
    tr.append(
        $('<td>').append(
            $('<select>')
                .attr('id', 'type' + i)
                .append($('<option>').text('Web page').attr('value', 'webpage'))
                .append($('<option>').text('Image').attr('value', 'image'))
        )
    );
    tr.append(
        $('<td>')
            .append(
                $('<form>').attr('onsubmit', 'return change(' + i + ')')
                    .append($('<input>').attr('type', 'submit').val('Change'))
                    .append($('<input>').attr('type', 'button').attr('onclick', 'full(' + i + ')').val('Fullscreen'))
            )
    );
    $('#content').append(tr);
}
</script>
<br>
<br>
Version 0.1
</body>
</html>
